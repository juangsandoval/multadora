<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‚öñÔ∏è C√≥mputo de t√©rminos judiciales</title>

  <link rel="stylesheet" href="styles.css" />
  <script type="module" src="app.js" defer></script>
</head>

<body>
  <main class="layout layout-centrado">
    <header>
      <h2>‚öñÔ∏è C√≥mputo de t√©rminos judiciales</h2>
    </header>

    <section aria-label="Formulario de c√≥mputo">
      <form id="formulario" novalidate>
        <!-- ============================= -->
        <!-- 1) NOTIFICACI√ìN -->
        <!-- ============================= -->
        <fieldset>
          <legend>üì¢ Notificaci√≥n</legend>

          <label>
            Tipo de notificaci√≥n:
            <select id="tipoNotificacion">
              <option value="Estados">Estados</option>
              <option value="Estrados">Estrados</option>
            </select>
          </label>

          <label>
            Fecha de notificaci√≥n:
            <input type="date" id="fechaNotificacion" />
          </label>
        </fieldset>

        <!-- ============================= -->
        <!-- 2) OBLIGACI√ìN CONDICIONAL -->
        <!-- ============================= -->
        <fieldset>
          <legend>‚è≥ Obligaci√≥n condicional</legend>

          <div class="toggle" role="radiogroup" aria-label="Modo de plazo condicional">
            <label>
              <input type="radio" name="modoPlazoCondicional" value="D√≠as" checked />
              Por d√≠as
            </label>
            <label>
              <input type="radio" name="modoPlazoCondicional" value="Fecha" />
              Por fecha
            </label>
          </div>

          <label id="grupoPlazoCondicionalDias">
            D√≠as h√°biles:
            <input type="number" id="plazoCondicionalDias" value="0" min="0" />
          </label>

          <label id="grupoPlazoCondicionalFecha" style="display:none;">
            Fecha l√≠mite:
            <input type="date" id="fechaLimiteCondicional" />
          </label>

          <label>
            Fecha en que se cumpli√≥ (si aplica):
            <input type="date" id="fechaCumplidaCondicional" />
          </label>
        </fieldset>

        <!-- ============================= -->
        <!-- 3) CUMPLIMIENTO (DDO) -->
        <!-- ============================= -->
        <fieldset>
          <legend>üìÖ Cumplimiento (Ddo)</legend>

          <div class="toggle" role="radiogroup" aria-label="Modo de plazo de cumplimiento">
            <label>
              <input type="radio" name="modoPlazoCumplimiento" value="D√≠as" checked />
              Por d√≠as
            </label>
            <label>
              <input type="radio" name="modoPlazoCumplimiento" value="Fecha" />
              Por fecha
            </label>
          </div>

          <label id="grupoCumplimientoDias">
            D√≠as h√°biles:
            <input type="number" id="diasCumplimiento" value="15" min="0" />
          </label>

          <label id="grupoCumplimientoFecha" style="display:none;">
            Fecha l√≠mite:
            <input type="date" id="fechaLimiteCumplimiento" />
          </label>
        </fieldset>

        <!-- ============================= -->
        <!-- 4) NOTICIA DE INCUMPLIMIENTO (DDTE) -->
        <!-- ============================= -->
        <fieldset>
          <legend>üì¨ Noticia de incumplimiento</legend>

          <label>
            D√≠as para informar:
            <input type="number" id="diasInforme" value="30" min="0" />
          </label>

          <label>
            Fecha del informe:
            <input type="date" id="fechaInforme" />
          </label>
        </fieldset>

        <!-- ============================= -->
        <!-- 5) AUTO DE INICIO -->
        <!-- ============================= -->
        <fieldset>
          <legend>üìÑ Auto de inicio de tr√°mite</legend>

          <label>
            Fecha del auto:
            <input type="date" id="fechaAutoInicio" />
          </label>

          <label>
            Plazo de acreditaci√≥n (d√≠as h√°biles):
            <input type="number" id="plazoAcreditacion" value="3" min="0" />
          </label>
        </fieldset>

        <!-- ============================= -->
        <!-- 6) AUTOS ADICIONALES -->
        <!-- ============================= -->
        <fieldset>
          <legend>üìë Autos adicionales</legend>

          <div id="autosContainer"></div>
          <button type="button" id="btnAgregarAuto">‚ûï A√±adir auto</button>
        </fieldset>

        <!-- ============================= -->
        <!-- ACCIONES -->
        <!-- ============================= -->
        <div class="acciones">
          <button type="button" id="btnCalcular">‚öôÔ∏è Calcular</button>
          <button type="button" id="btnDetalle">Mostrar detalle</button>
        </div>
      </form>
    </section>

    <aside id="preview" aria-live="polite">
      <h3>üìÑ Previsualizaci√≥n</h3>
      <p>Aqu√≠ aparecer√° el resumen del c√≥mputo.</p>
    </aside>

    <hr />

    <!-- ============================= -->
    <!-- SALIDAS -->
    <!-- ============================= -->
    <section aria-label="Resultados del c√≥mputo">
      <div id="salida" aria-live="polite"></div>

      <div id="detalle-calculo" style="display:none;" aria-live="polite"></div>
      <p><strong>Multa:</strong> <span id="multaNumero"></span></p>
      <p><strong>Multa (en letras):</strong> <span id="multaLetras"></span></p>

      <h4>Resumen mensual del c√≥mputo (d√≠as calendario sin suspensi√≥n)</h4>
      <button type="button" id="btnCopiarResumen">Copiar tabla</button>
      <div id="resumenMensual" aria-live="polite"></div>

      <h4>Detalle t√©rmino para cumplir (Ddo)</h4>
      <div id="detalleDias" aria-live="polite"></div>

      <h4>Detalle t√©rmino para informar (Ddte)</h4>
      <div id="detalleDiasInforme" aria-live="polite"></div>
    </section>
  </main>

  <!-- ============================= -->
  <!-- JS AUXILIAR DE UI (ideal: mover a app.js / ui.js) -->
  <!-- ============================= -->
  <script>
    // Toggle obligaci√≥n condicional (robusto: lee el checked actual)
    function refrescarModoCondicional() {
      const modo = document.querySelector("input[name='modoPlazoCondicional']:checked")?.value;
      document.getElementById("grupoPlazoCondicionalDias").style.display = (modo === "D√≠as") ? "block" : "none";
      document.getElementById("grupoPlazoCondicionalFecha").style.display = (modo === "Fecha") ? "block" : "none";
    }
    document.querySelectorAll("input[name='modoPlazoCondicional']").forEach(r => r.addEventListener("change", refrescarModoCondicional));
    refrescarModoCondicional();

    // Toggle cumplimiento (robusto: lee el checked actual)
    function refrescarModoCumplimiento() {
      const modo = document.querySelector("input[name='modoPlazoCumplimiento']:checked")?.value;
      document.getElementById("grupoCumplimientoDias").style.display = (modo === "D√≠as") ? "block" : "none";
      document.getElementById("grupoCumplimientoFecha").style.display = (modo === "Fecha") ? "block" : "none";
    }
    document.querySelectorAll("input[name='modoPlazoCumplimiento']").forEach(r => r.addEventListener("change", refrescarModoCumplimiento));
    refrescarModoCumplimiento();

    // Autos adicionales
    document.getElementById("btnAgregarAuto").addEventListener("click", () => {
      const cont = document.getElementById("autosContainer");

      const autoDiv = document.createElement("div");
      autoDiv.className = "auto-adicional";

      const labelFechaAuto = document.createElement("label");
      labelFechaAuto.textContent = "Fecha auto: ";
      const inputFechaAuto = document.createElement("input");
      inputFechaAuto.type = "date";
      inputFechaAuto.className = "fecha-auto";
      labelFechaAuto.appendChild(inputFechaAuto);

      const labelPlazo = document.createElement("label");
      labelPlazo.textContent = "Plazo (d√≠as h√°biles): ";
      const inputPlazo = document.createElement("input");
      inputPlazo.type = "number";
      inputPlazo.min = 0;
      inputPlazo.value = 0;
      inputPlazo.className = "plazo-auto";
      labelPlazo.appendChild(inputPlazo);

      const btnEliminar = document.createElement("button");
      btnEliminar.type = "button";
      btnEliminar.textContent = "üóë Eliminar";
      btnEliminar.className = "btn-eliminar-auto";
      btnEliminar.addEventListener("click", () => autoDiv.remove());

      const hr = document.createElement("hr");

      autoDiv.append(labelFechaAuto, labelPlazo, btnEliminar, hr);
      cont.appendChild(autoDiv);
    });
  </script>
</body>
</html>

